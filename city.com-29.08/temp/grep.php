<head>	<title>Search Files | WDSGR</title></head><?php$password = 'd83d67c001cd885c54cf563a06d53454c995a980';session_start();if (!isset($_SESSION['loggedIn'])) {    $_SESSION['loggedIn'] = false;}if (isset($_POST['password'])) {    if (sha1($_POST['password']) == $password) {        $_SESSION['loggedIn'] = true;    } else {        die ('Incorrect password');    }} if (!$_SESSION['loggedIn']): ?><html><head><title>Login</title></head>  <body>    <p>Rescticted Access</p>    <form method="post">      Password: <input type="password" name="password"> <br />      <input type="submit" name="submit" value="Login">    </form>  </body></html><?phpexit();endif;?><?phpdefine("SLASH", stristr($_SERVER[SERVER_SOFTWARE], "win") ? "\\" : "/");$path = ($_POST[path]) ? $_POST[path] : dirname(__FILE__);$q = $_POST[q];function php_grep($q, $path) {	$fp = opendir($path);	while ($f = readdir($fp)) {		if (preg_match("#^\.+$#", $f))			continue;		// ignore symbolic links		$file_full_path = $path . SLASH . $f;		if (is_dir($file_full_path)) {			$ret .= php_grep($q, $file_full_path);		} else if (stristr(file_get_contents($file_full_path), $q)) {			$ret .= "<tr><td>$file_full_path</td></tr>";		}	}	return $ret;}if ($q) {	$results = "<table><tbody>";	$results .= php_grep($q, $path);	$results .= "</tbody></table>";}echo <<<HRD	<form method=post>		<input type="text" name=path size=100 value="$path" /> Path 		<input type="text" name=q size=100 value="$q" /> Query<br>		<input type=submit value="Search">	</form>			$results	HRD;?><style>body {  background: #90befe none repeat scroll 0 0;  display: block;  position: relative;  width: 100%;}form, table {  display: block;  margin: 20px auto;  position: relative;  width: 1000px;}input {  margin: 1px 0;  width: 840px;}input[type="text"] {	-webkit-appearance: none;    -moz-appearance: none;    border: 1px solid #fff;    box-shadow: 1px 1px 2px 0 #707070 inset;    padding: 10px;    transition: box-shadow 0.3s ease 0s;    height: 50px;}input[type="text"]:focus, textarea:focus {  box-shadow: 1px 1px 2px 0 #c9c9c9 inset;}table tr td {  border: 2px solid #3d3d3d;  padding: 5px;}table tr td:hover {  background: #3d3d3d;  color: #fff;}input[type="submit"] {  background: rgba(174, 0, 0, 0.77) none repeat scroll 0 0;  border: medium none;  border-radius: 8px;  box-shadow: 2px 4px 6px #000;  color: #fff;  font-size: 120%;  font-weight: bold;  margin: 0 3% 0 0;  padding: 15px;  cursor: pointer;}</style>